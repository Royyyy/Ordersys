<div class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    {volist name='data' id='data'}
                    <div class="card-header" data-background-color="purple">
                        <h4 class="title">个人信息中心</h4>
                        <p class="category">欢迎来到{$data.userAccount}的个人信息管理中心</p>
                    </div>

                    <div class="card-content">
                        <form action="{:url('user/updateUserInfo')}" method="post" enctype="multipart/form-data" >
                            <div class="row">
                                <div class="col-md-5">
                                    <div class="form-group label-floating">
                                        <label class="control-label">密码(6-10位)</label>
                                        <input type="password" id="userPass" class="form-control" name="userPass" min="5" maxlength="10" onkeyup="validate()">

                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-5">
                                    <div class="form-group label-floating">
                                        <label class="control-label">确认密码</label>
                                        <input type="password" id="userPassComf" class="form-control" min="5" maxlength="10" onkeyup="validate()">
                                        <span id="tishi"></span>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-5">
                                    <div class="form-group label-floating">
                                        <input type="text" id="ImgURL" name="ImgURL" placeholder="图片地址" class="form-control" value="" disabled>

                                        <button type="button" class="am-btn am-btn-default am-btn-sm">
                                            <i class="am-icon-cloud-upload"></i> 浏览</button>
                                        <input id="doc-form-file" type="file" name="faceImg" onchange='PreviewImage(this)' multiple>
                                    </div>
                                </div>

                                <div class="col-md-5">
                                    <div id="imgPreview" class="am-u-sm-4 am-u-sm-centered am-u-end">
                                        <img id="img1" src="__DIR__{$data.faceImg}" alt="" style="width: 150px;height: 150px"/><!-- 显示缩略图 -->
                                    </div>
                                </div>

                            </div>
                            <input type="text" value="{$Think.session.userId}" name="userId" hidden>

                            <input type="submit" class="btn btn-primary pull-right" id="persubmit" value="确认"/>
                            <div class="clearfix"></div>
                        </form>
                    </div>
                    {/volist}
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">

    $(function() {
        $('#doc-form-file').on('change', function() {
            var fileNames = '';
            $.each(this.files, function() {
                fileNames +=  this.name ;
            });
            $('#ImgURL').val(fileNames);
        });
    });
    //===【浏览文件上传地址写入文本框】结束

    //缩略图显示方法
    function PreviewImage(imgFile)
    {
        var filextension=imgFile.value.substring(imgFile.value.lastIndexOf("."),imgFile.value.length);
        filextension=filextension.toLowerCase();
        if ((filextension!='.jpg')&&(filextension!='.gif')&&(filextension!='.jpeg')&&(filextension!='.png')&&(filextension!='.bmp'))
        {
            alert("对不起，系统仅支持标准格式的照片，请您调整格式后重新上传，谢谢 !");
            document.getElementById("imgPreview").innerHTML="<img id=\"img1\" src=\"__DIR__{$data.faceImg}\" alt=\"\" style=\"width: 150px;height: 150px\"/>";
            imgFile.focus();
        }
        else
        {
            var path;
            if(document.all)//IE
            {
                imgFile.select();
                path = document.selection.createRange().text;
                document.getElementById("imgPreview").innerHTML="";
                document.getElementById("imgPreview").style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true',sizingMethod='scale',src=\"" + path + "\")";//使用滤镜效果
            }
            else//FF
            {
                path=window.URL.createObjectURL(imgFile.files[0]);// FF 7.0以上
                //path = imgFile.files[0].getAsDataURL();// FF 3.0
                document.getElementById("imgPreview").innerHTML = "<img id='img1' style=\"width: 150px;height: 150px\"  src='"+path+"'/>";
                //document.getElementById("img1").src = path;
            }
        }
    }
    function validate() {
        var pwd1 = document.getElementById("userPass").value;
        var pwd2 = document.getElementById("userPassComf").value;
        if (pwd1.length>5){
        <!-- 对比两次输入的密码 -->
        if (pwd1 == '' || pwd2 == ''){
            document.getElementById("tishi").innerHTML="两次密码都不能为空";
            document.getElementById("persubmit").disabled = true;
        }
        else if(pwd1 != pwd2){
            document.getElementById("tishi").innerHTML="两次密码不相同";
            document.getElementById("persubmit").disabled = true;
        }else if(pwd1 == pwd2) {
            document.getElementById("tishi").innerHTML="两次密码相同";
            document.getElementById("persubmit").disabled = false;
        }
        }else{
            document.getElementById("tishi").innerHTML="密码长度必须为6-10位";
            document.getElementById("persubmit").disabled = true;
        }
    }


</script>